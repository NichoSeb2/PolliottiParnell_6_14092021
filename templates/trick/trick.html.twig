{% extends 'base.html.twig' %}

{% block title %}
	{{ parent() }}
	-
	{{ trick.name }}
{% endblock %}

{% block body %}
	<article class="container bg-light mb-5 p-0" style="margin-top: -90vh !important;">
		<div class="position-relative d-flex flex-column justify-content-center align-content-between w-100 text-center bg-image bg-shade" data-controller="bgimage" bg-image-url="{{ trick.coverImage.url }}" min-height="500px">
			<div class="col-lg-12">
				<h1 class="text-white">{{ trick.name }}</h1>

				{% if app.user %}
					<div class="position-absolute top-0 end-0">
						<button type="submit" class="btn p-1 fs-6">
							<i class="fas fa-pencil-alt"></i>
						</button>
						<button type="button" class="btn p-1 fs-6" data-bs-toggle="modal" data-bs-target="#trickDeleteModal">
							<i class="fas fa-trash-alt"></i>
						</button>
					</div>
				{% endif %}
			</div>
		</div>
		<div class="d-sm-flex d-none row w-100 text-center justify-content-center my-3" id="medias">
			{% for media in trick.medias %}
				<div class="col-lg-3 p-1 d-flex flex-column justify-content-center">
					{% if media.type == "image" %}
						<img src="{{ media.url }}" alt="{{ media.alt }}" class="d-block w-100">
					{% elseif media.type == "youtube" %}
						<div class="video_wrapper">
							<iframe width="100%" height="100%" src="https://www.youtube.com/embed/{{ videoIdExtractor.getYoutubeId(media.url) }}" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
						</div>
					{% elseif media.type == "vimeo" %}
						<div class="video_wrapper">
							<iframe src="https://player.vimeo.com/video/{{ videoIdExtractor.getVimeoId(media.url) }}" style="position:absolute;top:0;left:0;width:100%;height:100%;" frameborder="0" allow="autoplay; fullscreen; picture-in-picture" allowfullscreen></iframe>
						</div>
					{% else %}
					{% endif %}
				</div>
			{% else %}

			{% endfor %}
		</div>
		<div class="d-sm-none d-flex row w-100 text-center my-3">
			<div class="col-lg-12">
				<button type="button" class="btn btn-primary" data-controller="reveal" target="#medias">Voir les médias</button>
			</div>
		</div>
		<div class="row justify-content-center align-content-between w-100 text-center">
			<div class="col-lg-12">
				<p class="text-center px-2">Description : {{ trick.description }}</p>
			</div>
		</div>
		<hr class="h-2px w-80 mx-auto bg-primary">
		<div class="row justify-content-center align-content-between w-100 text-center">
			<div class="col-lg-12 d-flex flex-row flex-wrap justify-content-center">
				<p class="text-nowrap">Date de création : <b>{{ trick.createdAt|date("d/m/Y") }}</b></p>
				<i class="fas fa-circle text-primary mx-2" style="font-size: 19px;"></i>
				<p class="text-nowrap">Catégorie : <b>{{ trick.category.name }}</b></p>
				{% if trick.createdAt != trick.updatedAt %}
					<i class="fas fa-circle text-primary mx-2" style="font-size: 19px;"></i>
					<p class="text-nowrap">Date de modification : <b>{{ trick.updatedAt|date("d/m/Y") }}</b></p>
				{% endif %}
			</div>
		</div>
		{% if app.user %}
			<hr class="h-2px w-80 mx-auto bg-primary">
			<form action="" method="post" class="d-flex felx-row flex-wrap justify-content-center align-content-between w-100 m-0 p-0">
				<div class="col-xl-9 col-12 px-2 py-1">
					<input type="text" class="form-control">
				</div>
				<div class="col-xl-2 px-2 py-1">
					<button type="submit" class="btn btn-primary text-nowrap text-light">Laissez un commentaire</button>
				</div>
			</form>
		{% else %}
			<hr class="h-2px w-80 mx-auto bg-primary">
			<div class="row justify-content-center w-100">
				<p class="text-center">Lorem ipsum dolor sit amet consectetur adipisicing elit. Voluptatem, dolores!</p>
			</div>
		{% endif %}
		<hr class="h-2px w-80 mx-auto bg-primary">
		<div class="row justify-content-center align-content-between w-100 text-center px-2" id="commentsContainer">
			{% for comment in trick.comments %}
				<div class="col-lg-8 bg-white border mx-2 my-1 px-2 py-1 d-flex flex-row align-items-center">
					<h6>{{ comment.author.username }}, {{ comment.createdAt|date("d/m/Y") }} : </h6>
					<p class="px-2">{{ comment.content }}</p>
				</div>
			{% else %}
				
			{% endfor %}
		</div>
		<div class="row justify-content-center align-content-between w-100 text-center">
			<div class="col-lg-2">
				<button type="button" class="btn btn-secondary mt-3 mb-4">Load more</button>
			</div>
		</div>
	</article>

	{% include "parts/_trick_delete_modal.html.twig" %}
{% endblock %}
